package ronan_hanley.inside_av.weapons_systems;

import org.newdawn.slick.Image;

import ronan_hanley.inside_av.InsideAV;

public abstract class RocketWeaponSystem extends WeaponSystem {
	public static final double COST = 400;
	
	public RocketWeaponSystem(int x, int y, Image sprite) {
		super(x, y, sprite);
	}
	
	@Override
	public double getCost() {
		return COST;
	}
	
	@Override
	public void fire() {
		// fires one rocket.
		// subclasses can call this method multiple times.
		addProjectile(new Rocket(getX() + InsideAV.HALF_TILE_SIZE, getY() + InsideAV.HALF_TILE_SIZE, 0.2, this));
	}
	
	public void pointTowardsTarget() {
		if (target == null) return;
		
		// -- predict where the target will be --
		
		// first rotate the reference frame so the turret is underneath the enemy
		double distance = Math.sqrt(Math.pow(target.getXExact() - getXExact(), 2) + Math.pow(target.getYExact() - getYExact(), 2));
		double targetNewX = getXExact();
		double targetNewY = getYExact() - distance;
		double targetShiftDistance = Math.sqrt(Math.pow(targetNewX - target.getXExact(), 2) + Math.pow(targetNewY - target.getTileY(), 2));
		
		// use the law of cosines to find the change in angle
		// C = acos( (a^2 + b^2 - c^2) / 2ab )
		// (we can simplify a bit because a == b)
		double angleShift = Math.acos(Math.pow(distance, 2) * 2 - Math.pow(targetShiftDistance, 2) / (4 * distance));
	}
	
}
